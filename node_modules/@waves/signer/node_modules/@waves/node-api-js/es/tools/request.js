import resolve from './resolve';
import parse from './parse';
const request = typeof fetch === 'function' ? fetch : require('node-fetch');
export default function (params) {
    return request(resolve(params.url, params.base), updateHeaders(params.options))
        .then(parseResponse);
}
export function parseResponse(r) {
    return r.text().then(message => r.ok ? parse(message) : Promise.reject(tryParse(message)));
}
function tryParse(message) {
    try {
        return JSON.parse(message);
    }
    catch (e) {
        return message;
    }
}
function updateHeaders(options = Object.create(null)) {
    return Object.assign({ credentials: 'include' }, options);
}
//# sourceMappingURL=request.js.map